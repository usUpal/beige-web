(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[452],{1094:function(e,t,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/fileManager",function(){return l(3899)}])},4860:function(e,t,l){"use strict";var a=l(7066),s=l(3197);let r=a.Z.create({baseURL:s.ZP.APIEndpoint}),reqConfig=e=>({headers:{Authorization:"Bearer ".concat(e.idToken)}});t.Z={idToken:null,getFiles(e){try{return r.get("/get-files/".concat(e),reqConfig(this))}catch(e){throw console.error("Error in getFiles:",e),e}},async checkIsPublic(e){try{let t=await r.head(s.ZP.BucketUrl+e+"?bc_timestamp=".concat(new Date().getTime()));return t.ok||console.log("Bad"),200===t.status}catch(e){return console.error("Error in checkIsPublic:",e),!1}},setPublicOrPrivate(e,t){try{return r.post(t?"/set-public":"/set-private",{filepath:e},reqConfig(this))}catch(t){throw console.error("Error in setPublicOrPrivate for ".concat(e,":"),t),t}},async getSharableUrl(e,t){try{let l=await r.post("/get-share-url",{filepath:e,download:t},reqConfig(this));return l.data}catch(e){throw console.error("Error in getSharableUrl:",e),e}},addFolder(e){try{return r.post("/add-folder",{folderpath:e},reqConfig(this))}catch(t){throw console.error("Error in addFolder for ".concat(e,":"),t),t}},deleteFile(e){try{return r.post("/delete-file",{filepath:e},reqConfig(this))}catch(t){throw console.error("Error in deleteFile for ".concat(e,":"),t),t}},async moveFile(e,t){try{let l=await r.post("/move-file",{filepath:e,destination:t},reqConfig(this));return l.data}catch(l){throw console.error("Error in moveFile for ".concat(e," to ").concat(t,":"),l),l}},async getNewUploadPolicy(e,t,l){try{let a=await r.post("/get-new-upload-policy",{filepath:e,fileContentType:t,fileSize:l},reqConfig(this));return a.data}catch(t){throw console.error("Error in getNewUploadPolicy for ".concat(e,":"),t),t}},postFile(e,t,l){try{let s=new FormData;for(let[t,l]of Object.entries(e.fields))s.append(t,l);s.append("file",t);let r=a.Z.CancelToken.source(),i=a.Z.post(e.url,s,{onUploadProgress:e=>l(e.loaded/e.total),cancelToken:r.token});return[i,()=>r.cancel()]}catch(e){throw console.error("Error in postFile:",e),e}},async getSettings(){try{let e=await r.get("/get-settings",reqConfig(this));return e.data.settings}catch(e){throw console.error("Error in getSettings:",e),e}},async saveSettings(e){try{let t=await r.post("/save-settings",{settings:e},reqConfig(this));return t.data}catch(e){throw console.error("Error in saveSettings:",e),e}},async downloadFolder(e){try{let t=await r.get("/download-folder?folderpath=".concat(encodeURIComponent(e)),{...reqConfig(this),responseType:"blob"}),l=new Blob([t.data],{type:"application/zip"}),a=window.URL.createObjectURL(l),s=document.createElement("a");s.style.display="none",s.href=a,s.download="".concat(e.split("/").pop(),".zip"),document.body.appendChild(s),s.click(),window.URL.revokeObjectURL(a)}catch(t){throw console.error("Error in downloadFolder for ".concat(e,":"),t),t}}}},3899:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return fileManager}});var a=l(5893),s=l(7294),r=l(2920),i=l(1018);function formatBytes(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(0===e)return"0 Bytes";let l=t<0?0:t,a=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,a)).toFixed(l))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][a]}var n=l(4860),o=l(3197),c=l(9078),d=l(5675),p=l.n(d),Menu_Menu=e=>{let{setFileUploadOpen:t,setFolderCreatorOpen:l,setSettingsOpen:s,path:r}=e,{userData:i}=(0,c.a)();return(0,a.jsx)("div",{className:"flex items-start justify-between",children:(0,a.jsxs)("div",{className:"mr-48 flex items-center justify-between gap-6",children:[r.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("h6",{className:"flex items-center gap-2 rounded-md px-4 py-2 text-lg",onClick:()=>t(!0),children:[(0,a.jsx)(p(),{src:"/assets/icons/uploadCloud.png",alt:"refresh",width:18,height:18}),"Upload Files"]}),(0,a.jsxs)("h6",{className:"rounded-mdx-4 flex items-center gap-2 py-2 text-lg",onClick:()=>l(!0),children:[(0,a.jsx)(p(),{src:"/assets/icons/create-folder.png",alt:"refresh",width:18,height:18}),"Create Folder"]})]}),(null==i?void 0:i.role)==="manager"&&(0,a.jsxs)("h6",{className:"flex items-center gap-2 rounded-md px-4 py-2 text-lg",onClick:()=>s(!0),children:[(0,a.jsx)(p(),{src:"/assets/icons/setting.png",alt:"refresh",width:18,height:18}),"File Settings"]})]})})},h=l(3317),u=l(1355),m=l(806),FileExplorer_FileExplorer=e=>{let{idToken:t,setExplorerPath:l,doRefresh:d,didRefresh:p,setFileUploadOpen:x,setFolderCreatorOpen:f,setSettingsOpen:g}=e,{userData:b}=(0,c.a)(),[j,v]=(0,s.useState)({loading:!1,loadingError:!1,bucketName:"objects"}),[y,w]=(0,s.useState)([]),[N,k]=(0,s.useState)([]),[F,C]=(0,s.useState)("list"),[S,U]=(0,s.useState)(!1),[P,D]=(0,s.useState)(!1),[E,T]=(0,s.useState)({open:!1,saving:!1,error:!1,file:"",isFolder:!1}),[M,_]=(0,s.useState)({}),[A,z]=(0,s.useState)(""),[R,Z]=(0,s.useState)({}),[B,I]=(0,s.useState)({}),[O,L]=(0,s.useState)(!1),[q,V]=(0,s.useState)([]),setPath=e=>{w(e),l(e)},filesInPath=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,t=arguments.length>1?arguments[1]:void 0;return N.map(e=>{let t=e.path.endsWith("/"),l=t?e.path.slice(0,-1).split("/"):e.path.split("/");return{...e,isFolder:t,splitPath:l,name:l[l.length-1]}}).filter(l=>!!t||!(l.splitPath===e||l.name.includes(".bucket."))&&(!e.length&&1===l.splitPath.length||!!(l.splitPath.slice(0,-1).toString()===e.toString()&&e.length))).sort((e,t)=>t.isFolder-e.isFolder)},getFiles=()=>{v({...j,loading:!0,loadingError:!1}),n.Z.getFiles(null==b?void 0:b.id).then(e=>{let{data:t}=e;k(t.files),v({...j,loadingError:!1,loading:!1,bucketName:t.bucket})}).catch(()=>v({...j,loading:!1,loadingError:!0}))};(0,s.useEffect)(()=>{v({...j,loading:!0}),getFiles()},[t,d]);let deleteFile=()=>{T({...E,saving:!0}),n.Z.deleteFile(E.file).then(e=>{U(!1),(0,r.Am)("❗ ".concat(E.isFolder?"Folder":"File"," deleted")),e.data.deleted&&T({...E,open:!1,error:!1,saving:!1}),getFiles()}).catch(e=>{T({...E,error:!0,saving:!1})})},fileCards=()=>filesInPath(y,P).map(e=>(0,a.jsx)(i.Z,{id:e.id,selectFileIds:q,path:y,cardType:F,fileType:e.contentType,isFolder:e.isFolder,lastMod:function(e){let t=6e4*new Date().getTimezoneOffset(),l=new Date(new Date(e)-t);return l.toISOString().slice(0,19).replace(/-/g,"/").replace("T"," at ")}(e.updated),name:P?e.path:e.name,size:formatBytes(e.size),isDimmed:!!R.path&&!e.isFolder,onDelete:()=>{T({...E,open:!0,file:e.path,isFolder:e.isFolder})},onRename:()=>{_(e),z(e.name)},onMove:()=>{Z(e),I({})},onClickItem:async()=>{if(R.path)I(e);else if(e.isFolder)D(!1),setPath(e.path.slice(0,-1).split("/"));else if(await n.Z.checkIsPublic(e.path))navigator.clipboard.writeText(o.ZP.CDN_URL+e.path).then(()=>{(0,r.Am)("\uD83D\uDCCB File URL copied to clipboard")}).catch(()=>{(0,r.Am)("File URL: ".concat(o.ZP.CDN_URL+e.path),{position:"top-center",draggable:!1,closeOnClick:!1,autoClose:1e4})});else{let{url:t,duration:l}=await n.Z.getSharableUrl(e.path,!0);t||(0,r.Am)("\uD83D\uDEAB Couldn't get sharable URL. Try making the file public instead."),navigator.clipboard.writeText(t).then(()=>{(0,r.Am)("\uD83D\uDD17 Sharable URL copied to clipboard. It will expire in ".concat(l," days. Make this file public to get a permanent public link."),{autoClose:2e3})}).catch(()=>{(0,r.Am)("Sharable URL (will expire in ".concat(l," days): ").concat(t),{position:"top-center",draggable:!1,closeOnClick:!1,autoClose:2e3})})}},onDownload:async t=>{if(t)window.open(e.downloadLink,"_blank");else if(e.isFolder)try{await n.Z.downloadFolder(e.path)}catch(e){console.error("There was an error downloading the folder:",e)}else{let{url:t}=await n.Z.getSharableUrl(e.path,!0);console.log("\uD83D\uDE80 ~ onDownload={ ~ url:",t),window.open(t,"_blank")}},checkIsPublic:()=>n.Z.checkIsPublic(e.path),onSetPublic:t=>{n.Z.setPublicOrPrivate(e.path,t).then(()=>{(0,r.Am)(t?"\uD83C\uDF0E File is now publicly accessible":"\uD83D\uDD11 File is now private")}).catch(()=>{(0,r.Am)("❓ Something went wrong")})},handleDropDown:handleDropDown},e.id)),handleDropDown=e=>{q.includes(e)?V([]):V([e])};return(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{children:(0,a.jsx)("p",{className:"my-8 text-2xl",children:"Files"})}),(0,a.jsxs)("div",{className:"flex items-center justify-start gap-4",children:[(0,a.jsxs)("label",{className:"flex items-center cursor-pointer",children:[(0,a.jsx)("input",{type:"checkbox",className:"form-checkbox h-4 w-4 border-black focus:outline-black text-black",checked:P,onChange:()=>D(!P)}),(0,a.jsx)("span",{className:"ml-2 text-lg text-gray-900 font-normal",children:"Ignore Folder Structure"})]}),(0,a.jsxs)("p",{className:"mb-0 flex items-center gap-2 px-4 text-lg",onClick:getFiles,children:[(0,a.jsx)("img",{src:"/allSvg/refresh.svg",alt:"refresh",className:"size-6"}),"Refresh"]}),(0,a.jsx)(Menu_Menu,{setFileUploadOpen:x,setFolderCreatorOpen:f,setSettingsOpen:g,path:y})]}),(0,a.jsx)("div",{className:"",children:(0,a.jsx)("nav",{className:"flex","aria-label":"Breadcrumb",children:(0,a.jsxs)("ol",{className:"flex items-center mt-3 mb-5",children:[(0,a.jsx)("li",{className:"mr-2",children:(0,a.jsx)("span",{className:"text-gray-500",children:h.w.folderIcon})}),(0,a.jsx)("li",{children:(0,a.jsx)("a",{href:"#",className:"text-gray-500 ".concat(y.length?"hover:text-blue-600":"font-bold"),onClick:()=>setPath([]),children:j.bucketName?"Beige":""})}),y.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("li",{className:"mx-2",children:(0,a.jsx)("span",{className:"text-gray-300",children:"/"})}),y.map((e,t)=>(0,a.jsxs)("li",{children:[(0,a.jsx)("a",{href:"#",className:"text-gray-500 ".concat(y.length===t+1?"font-bold":"hover:text-blue-600"),onClick:()=>setPath(y.slice(0,t+1)),children:e}),t!==y.length-1&&(0,a.jsx)("span",{className:"mx-2 text-gray-300",children:"/"})]},t))]})]})})}),(0,a.jsxs)("div",{className:"files",children:[(0,a.jsxs)("div",{className:"message",children:[j.loading&&(0,a.jsxs)("div",{className:"  border px-4 py-3 rounded relative flex items-center mb-10",role:"alert",children:[(0,a.jsx)("div",{className:"h-12 w-20",children:(0,a.jsx)("div",{className:"h-12 w-12",children:h.w.roundSpinIcon})}),(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsx)("span",{className:"block sm:inline font-bold",children:"Please wait..."}),(0,a.jsx)("span",{className:"block sm:inline",children:"We are gathering your files... "})]})]}),j.loadingError&&(0,a.jsxs)("div",{className:" border px-4 py-3 rounded relative flex items-center mb-10",role:"alert",children:[(0,a.jsx)("div",{className:"h-12 w-20",children:(0,a.jsx)("div",{className:" h-12 w-12 flex justify-center items-center",children:h.w.invalidIcon})}),(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsx)("span",{className:"block sm:inline font-bold",children:"Something went wrong."}),(0,a.jsxs)("span",{className:"block sm:inline pe-4",children:["Either the request failed or you are not authorized to access these files.",(0,a.jsx)("a",{href:"#",className:"ps-6",onClick:getFiles,children:"Try again."})]})]})]})]}),!filesInPath().length&&!j.loading&&!P&&(0,a.jsx)("p",{children:"There are no files here : "}),(0,a.jsx)("div",{className:"",children:"list"===F?(0,a.jsx)("ul",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6 gap-4",children:fileCards().map((e,t)=>(0,a.jsx)("li",{className:"relative",children:e},t))}):(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 xl:grid-cols-6 gap-4 ",children:fileCards().map((e,t)=>(0,a.jsx)("div",{className:"file-card relative shadow-md rounded-lg",children:e},t))})})]}),(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{className:"mb-5",children:(0,a.jsx)(u.u,{appear:!0,show:E.open,as:s.Fragment,children:(0,a.jsxs)(m.V,{as:"div",open:E.open,onClose:()=>{T({...E,open:!1,error:!1,saving:!1})},children:[(0,a.jsx)(u.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,a.jsx)("div",{className:"fixed inset-0"})}),(0,a.jsx)("div",{className:"fixed inset-0 bg-[black]/60 z-[999] overflow-y-auto",children:(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen px-4",children:(0,a.jsx)(u.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,a.jsxs)(m.V.Panel,{as:"div",className:"panel border-0 p-0 rounded-lg overflow-hidden w-full max-w-lg my-8 text-black dark:text-white-dark",children:[(0,a.jsxs)("div",{className:"flex bg-[#fbfbfb] dark:bg-[#121c2c] items-center justify-between px-5 py-3",children:[(0,a.jsxs)("div",{className:"text-lg font-bold capitalize text-red-600",children:["Delete ",E.isFolder?"folder":"file"]}),(0,a.jsx)("button",{type:"button",className:"text-white-dark hover:text-dark text-[16px]",onClick:()=>{T({...E,open:!1,error:!1,saving:!1})},children:h.w.closeModalSvg})]}),(0,a.jsxs)("div",{className:"p-5 ",children:[" ",(0,a.jsx)("p",{className:"bg-rose-100 flex flex-col items-center text-danger",children:h.w.trashIcon}),(0,a.jsxs)("p",{className:" font-semibold",children:[" ","Are you sure you want to delete ",(0,a.jsxs)("span",{className:"text-danger",children:[" ",E.file]}),"?"]}),(0,a.jsxs)("div",{className:"flex justify-end items-center mt-8",children:[(0,a.jsx)("button",{type:"button",className:"btn btn-outline-danger text-[16px]",onClick:()=>{T({...E,open:!1,error:!1,saving:!1})},children:"No"}),(0,a.jsx)("button",{type:"button",className:"btn btn-primary ltr:ml-4 rtl:mr-4 text-[16px]",onClick:()=>deleteFile(),children:E.saving?"Deleting...":"Yes"})]})]})]})})})})]})})})}),(0,a.jsx)(u.u,{appear:!0,show:!!M.path,as:s.Fragment,children:(0,a.jsxs)(m.V,{as:"div",open:!!M.path,onClose:()=>_({}),children:[(0,a.jsx)(u.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,a.jsx)("div",{className:"fixed inset-0"})}),(0,a.jsx)("div",{className:"fixed inset-0 bg-[black]/60 z-[999] overflow-y-auto",children:(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen px-4",children:(0,a.jsx)(u.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,a.jsxs)(m.V.Panel,{as:"div",className:"panel border-0 p-0 rounded-lg overflow-hidden w-full max-w-lg my-8 text-black dark:text-white-dark",children:[(0,a.jsxs)("div",{className:"flex bg-[#fbfbfb] dark:bg-[#121c2c] items-center justify-between px-5 py-3",children:[(0,a.jsx)("h5",{className:"font-bold text-lg",children:"Rename"}),(0,a.jsx)("button",{type:"button",className:"text-white-dark hover:text-dark text-[16px]",onClick:()=>{_({}),z("")},children:h.w.closeBtnCp})]}),(0,a.jsxs)("div",{className:"px-5 pb-5 flex flex-col items-center",children:[(0,a.jsx)("p",{className:"flex flex-col items-center text-info",children:h.w.docEditIcon}),(0,a.jsxs)("p",{className:"font-semibold",children:["Rename ",(0,a.jsxs)("span",{className:"text-blue-400",children:[" ",M.name]})]}),(0,a.jsx)("p",{children:(0,a.jsx)("input",{className:"border p-3 rounded capitalize focus:outline-none focus:border-gray-600",placeholder:"New name",value:A,onChange:e=>z(e.target.value)})}),(0,a.jsxs)("div",{className:"flex justify-end items-center mt-8",children:[(0,a.jsx)("button",{type:"button",className:"btn btn-outline-danger text-[16px]",onClick:()=>{_({}),z("")},children:"Cancel"}),(0,a.jsx)("button",{type:"button",className:"btn btn-primary ltr:ml-4 rtl:mr-4 text-[16px]",onClick:()=>{let e=M.path.split("/");e[M.path.split("/").length-1]=A,n.Z.moveFile(M.path,e.join("/")).then(e=>{if(!e.success)return Promise.reject();(0,r.Am)("\uD83D\uDD8A File renamed!"),z(""),getFiles()}).catch(()=>(0,r.Am)("❗ Couldn't rename file. Make sure a file with the same name doesn't already exist.")),_({})},children:"Rename"})]})]})]})})})})]})})]})},x=l(7066);let uploadCancelFunc=()=>{},f={files:[],status:"",progress:0,totalProgress:0,totalUploadSize:0,totalUploadedSize:0,uploading:!1,error:!1,folderUpload:!1,uploadCancelled:!1};function uploadStateReducer(e,t){switch(t.type){case"reset":if(t.betweenSteps)return{...e,status:t.status||"",progress:0,error:!1};return uploadCancelFunc(),{...f};case"setStatus":return{...e,status:t.status};case"uploadError":return console.error(t.error),{...e,error:!0,uploading:!1,progress:100,status:t.error+" (preceding files successfully uploaded)"};case"setUploading":return{...e,uploading:t.uploading};case"setProgress":return{...e,progress:Math.round(1e3*t.rawProgress)/10};case"addUploadedAmount":let l=e.totalUploadedSize+t.amount;return{...e,totalUploadedSize:l,totalProgress:l/e.totalUploadSize*100};case"setFiles":let a=0;for(let e of t.files)a+=e.size||0;return{...e,files:t.files||[],totalUploadSize:a};case"switchFolderUpload":return{...e,folderUpload:!e.folderUpload}}}var FileUploadModal_FileUploadModal=e=>{let{open:t,closeModal:l,path:i,onSuccess:o}=e,c=(0,s.createRef)(),[d,p]=(0,s.useReducer)(uploadStateReducer,f),startUpload=async()=>{let e=(await n.Z.getSettings()).defaultPublicFiles,handleStepFail=(e,t)=>(console.error(e),Promise.reject(t));for(let[t,l]of d.files.entries())try{p({type:"setUploading",uploading:!0}),p({type:"reset",betweenSteps:!0,status:"Requesting upload policy..."});let a=await n.Z.getNewUploadPolicy(null==l?void 0:l.name,null==l?void 0:l.type,null==l?void 0:l.size).catch(e=>handleStepFail(e,"Unable to get upload policy for file ".concat(t+1)));p({type:"setStatus",status:"Uploading file ".concat(t+1," of ").concat(d.files.length,"...")});let[s,i]=n.Z.postFile(a,l,e=>p({type:"setProgress",rawProgress:e}));uploadCancelFunc=i;let c=!1;if(await s.catch(e=>{if(x.Z.isCancel(e)){c=!0;return}return handleStepFail(e,"Unable to upload file ".concat(t+1))}),c)break;p({type:"addUploadedAmount",amount:l.size||0}),p({type:"setStatus",status:"Setting file ".concat(e?"public":"private","...")}),t===d.files.length-1&&((0,r.Am)("\uD83D\uDE80 All files uploaded!"),p({type:"reset"}),setTimeout(o,1e3))}catch(e){p({type:"uploadError",error:e});break}},g=d.files.map(e=>(console.log(e),(0,a.jsxs)("li",{children:[(0,a.jsx)("span",{children:e.name})," - ",formatBytes(e.size)]},e.name)));return(0,a.jsx)("div",{children:(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{className:"mb-5",children:(0,a.jsx)(u.u,{appear:!0,show:t,as:s.Fragment,children:(0,a.jsxs)(m.V,{as:"div",open:t,onClose:()=>p({type:"switchFolderUpload"}),children:[(0,a.jsx)(u.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,a.jsx)("div",{className:"fixed inset-0"})}),(0,a.jsx)("div",{className:"fixed inset-0 bg-[black]/60 z-[999] overflow-y-auto",children:(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen px-4",children:(0,a.jsx)(u.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,a.jsxs)(m.V.Panel,{as:"div",className:"panel my-24 w-3/6 overflow-hidden rounded-lg border-0 p-0 text-black dark:text-white-dark pb-6",children:[(0,a.jsxs)("div",{className:"flex bg-[#fbfbfb] dark:bg-[#121c2c] items-center justify-between px-5 py-3",children:[(0,a.jsxs)("div",{className:"text-lg font-bold capitalize text-red-600",children:["Upload ",d.folderUpload?"a Folder":"Files"]}),(0,a.jsx)("button",{type:"button",className:"text-white-dark hover:text-dark text-[16px]",onClick:()=>{p({type:"reset"}),l()},children:h.w.closeModalSvg})]}),(0,a.jsxs)("div",{className:"px-5",children:[(0,a.jsxs)("p",{className:"flex items-center",children:[(0,a.jsxs)("label",{className:"w-12 h-6 relative",onClick:()=>p({type:"switchFolderUpload"}),children:[(0,a.jsx)("input",{type:"checkbox",className:"custom_switch absolute w-full h-full opacity-0 z-10 cursor-pointer peer",id:"custom_switch_checkbox1",checked:d.folderUpload}),(0,a.jsx)("span",{className:"bg-[#ebedf2] dark:bg-dark block h-full rounded-full before:absolute before:left-1 before:bg-white dark:before:bg-white-dark dark:peer-checked:before:bg-white before:bottom-1 before:w-4 before:h-4 before:rounded-full peer-checked:before:left-7 peer-checked:bg-primary before:transition-all before:duration-300"})]}),(0,a.jsxs)("span",{className:"ms-3 ",children:["Select ",d.folderUpload?"Files":"a Folder"]})]}),(0,a.jsx)("p",{className:" font-semibold",children:(0,a.jsxs)("p",{children:["You can select multiple files or a single folder to upload. If you upload a folder, file structure will be preserved. Files will be uploaded to ",(i||[]).join("/")+"/","."]})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("input",{style:{display:"none"},multiple:!0,type:"file",webkitdirectory:d.folderUpload?"":void 0,mozdirectory:d.folderUpload?"":void 0,msdirectory:d.folderUpload?"":void 0,odirectory:d.folderUpload?"":void 0,directory:d.folderUpload?"":void 0,ref:c,onChange:e=>{let t=i.length?i.join("/")+"/":"",l=Array.from(e.target.files).map(e=>{let l=t+(d.folderUpload?e.webkitRelativePath:e.name),a=new File([e],l,{type:e.type});return a});if(d.folderUpload){let e=[];for(let t of l){let l=t.name.split("/").slice(0,-1).join("/")+"/";console.log(l),e.includes(l)||e.push(l)}e=e.map(e=>new File([""],e)),console.log(l=l.concat(e))}p({type:"setFiles",files:l})}}),(0,a.jsxs)("button",{type:"button",className:"btn btn-dark text-[18px]",style:{display:"block",margin:"15px auto"},onClick:()=>c.current.click(),disabled:d.uploading,children:["Select ",d.folderUpload?"a Folder":"Files"]})]}),(0,a.jsx)("div",{children:(0,a.jsx)("li",{className:"list-none",children:g})}),d.status&&(0,a.jsx)("div",{className:"mb-5 space-y-5",children:(0,a.jsx)("div",{className:"w-full h-4 bg-[#ebedf2] dark:bg-dark/40 rounded-full",children:(0,a.jsx)("div",{className:"bg-info h-4 rounded-full text-right text-white text-xs",style:{width:"".concat(d.progress,"%")},children:d.uploading?"".concat(d.progress,"%"):d.error?"Error!":"".concat(d.progress,"%")})})}),(0,a.jsx)("p",{style:{textAlign:"right",marginRight:"30px",color:d.error?"red":"black"},children:(0,a.jsx)("strong",{children:d.status})}),(0,a.jsxs)("div",{className:"flex justify-end items-center mt-8",children:[(0,a.jsx)("button",{className:"mr-3 btn btn-outline-dark text-[16px]",color:"black",onClick:()=>{p({type:"reset"}),l()},children:"Cancel"}),(0,a.jsxs)("button",{className:" flex items-center btn btn-outline-secondary relative text-[16px]",onClick:startUpload,disabled:!d.files.length||d.uploading,children:[(0,a.jsx)("span",{className:"flex items-center justify-center duration-300",children:h.w.uploadIcon}),d.uploading?"Uploading...":"Start Upload"]})]})]})]})})})})]})})})})})},FolderCreationModal=e=>{let{open:t,closeModal:l,path:i,onSuccess:o}=e,[c,d]=(0,s.useState)(""),[p,x]=(0,s.useState)(!1),[f,g]=(0,s.useState)(!1),close=()=>{g(!1),x(!1),l()};return(0,a.jsx)("div",{children:(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{className:"mb-5",children:(0,a.jsx)(u.u,{appear:!0,show:t,as:s.Fragment,children:(0,a.jsxs)(m.V,{as:"div",open:t,onClose:close,children:[(0,a.jsx)(u.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,a.jsx)("div",{className:"fixed inset-0"})}),(0,a.jsx)("div",{className:"fixed inset-0 bg-[black]/60 z-[999] overflow-y-auto",children:(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen px-4",children:(0,a.jsx)(u.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,a.jsxs)(m.V.Panel,{as:"div",className:"panel border-0 p-0 rounded-lg overflow-hidden w-11/12 max-w-lg my-8 text-black dark:text-white-dark",children:[(0,a.jsxs)("div",{className:"flex bg-[#fbfbfb] dark:bg-[#121c2c] items-center justify-between px-5 py-3",children:[(0,a.jsx)("h5",{className:"font-bold text-lg",children:"Create folder"}),(0,a.jsx)("button",{type:"button",className:"text-white-dark hover:text-dark text-[16px]",onClick:close,children:h.w.closeBtnCp})]}),(0,a.jsxs)("div",{className:"p-5",children:[(0,a.jsx)("p",{children:"Your new folder will be created in the current directory."}),(0,a.jsx)("p",{children:(0,a.jsxs)("div",{className:"mb-5",children:[(0,a.jsx)("label",{htmlFor:"url",children:"Folder"}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("div",{className:"bg-[#eee] flex justify-center items-center ltr:rounded-l-md rtl:rounded-r-md px-3 font-semibold border ltr:border-r-0 rtl:border-l-0 border-white-light dark:border-[#17263c] dark:bg-[#1b2e4b] ",children:(i[i.length-1]||"")+"/"}),(0,a.jsx)("input",{onChange:e=>d((i.length?i.join("/")+"/":"")+e.target.value),id:"new_folder",type:"text",placeholder:"New Folder Name",className:"form-input ltr:rounded-l-none rtl:rounded-r-none "}),f&&(0,a.jsx)("p",{style:{color:"red",margin:"10px 0"},children:"Something went wrong and we couldn't create that folder."})]})]})}),(0,a.jsxs)("div",{className:"flex justify-end items-center mt-8",children:[(0,a.jsx)("button",{type:"button",className:"btn btn-outline-danger text-[16px]",onClick:close,children:"Discard"}),(0,a.jsx)("button",{type:"button",className:"btn btn-outline-warning ltr:ml-4 rtl:mr-4 text-[16px]",onClick:()=>{x(!0),n.Z.addFolder(c).then(e=>{x(!1),g(!1),e.data.saved&&(o(),r.Am.success("\uD83D\uDCC1 Folder created!"))}).catch(e=>{x(!1),g(!0)})},children:p?"Adding...":"Add Folder"})]})]})]})})})})]})})})})})},SettingsModal_SettingsModal=e=>{let{open:t,closeModal:l}=e,[i,o]=(0,s.useState)({}),[c,d]=(0,s.useState)(!0);(0,s.useEffect)(()=>{t&&(d(!0),n.Z.getSettings().then(e=>{o({...e,useSettings:!0}),d(!1)}))},[t]);let saveSettings=()=>{n.Z.saveSettings(i).then(()=>(0,r.Am)("⚙️ Settings saved")).catch(e=>(0,r.Am)("❌ An error occurred and we couldn't save your settings"))},close=()=>{saveSettings(),l()};return console.log(i),(0,a.jsx)("div",{children:(0,a.jsx)("div",{className:"mb-5",children:(0,a.jsx)(u.u,{appear:!0,show:t,as:s.Fragment,children:(0,a.jsxs)(m.V,{as:"div",open:t,onClose:close,children:[(0,a.jsx)(u.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,a.jsx)("div",{className:"fixed inset-0"})}),(0,a.jsx)("div",{className:"fixed inset-0 bg-[black]/60 z-[999] overflow-y-auto",children:(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen px-4",children:(0,a.jsx)(u.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,a.jsxs)(m.V.Panel,{as:"div",className:"panel my-24 w-2/5 md:w-3/5 overflow-hidden rounded-lg border-0 p-0 text-black dark:text-white-dark pb-2",children:[(0,a.jsxs)("div",{className:"flex bg-[#fbfbfb] dark:bg-[#121c2c] items-center justify-between px-5 py-3",children:[(0,a.jsx)("div",{className:"text-lg font-bold capitalize",children:"Options & Settings"}),(0,a.jsx)("button",{type:"button",className:"text-white-dark hover:text-dark text-[16px]",onClick:()=>{l()},children:h.w.closeModalSvg})]}),(0,a.jsxs)("div",{className:"p-5 ",children:[(0,a.jsx)("p",{children:"Your settings will be saved in a file in your storage bucket."}),(0,a.jsxs)("div",{className:"",children:[(0,a.jsx)("label",{children:"Default File Privacy"}),(0,a.jsxs)("p",{className:"flex items-center",children:[(0,a.jsxs)("label",{className:"w-12 h-6 relative",onClick:()=>o({...i,defaultPublicFiles:!i.defaultPublicFiles}),children:[(0,a.jsx)("input",{type:"checkbox",className:"custom_switch absolute w-full h-full opacity-0 z-10 cursor-pointer peer",id:"custom_switch_checkbox1",checked:i.defaultPublicFiles}),(0,a.jsx)("span",{className:"bg-[#ebedf2] dark:bg-dark block h-full rounded-full before:absolute before:left-1 before:bg-white dark:before:bg-white-dark dark:peer-checked:before:bg-white before:bottom-1 before:w-4 before:h-4 before:rounded-full peer-checked:before:left-7 peer-checked:bg-primary before:transition-all before:duration-300"})]}),(0,a.jsx)("span",{className:"ps-2 pb-2 ",children:"Uploaded files are ".concat(i.defaultPublicFiles?"public":"private"," by default")})]})]}),(0,a.jsxs)("p",{className:" font-semibold mt-2 mb-4",children:[(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"",children:"Private URL Expiration"}),(0,a.jsx)("span",{className:"font-normal text-[13px]",children:"Shared links for private files will expire after"})]}),(0,a.jsx)("form",{action:"",onChange:e=>o({...i,privateUrlExpiration:e.currentTarget.value}),children:(0,a.jsxs)("div",{className:"flex w-72 mt-2",children:[(0,a.jsx)("input",{type:"number",placeholder:"",className:"form-input ltr:rounded-r-none rtl:rounded-l-none flex-1 ltr:rounded-l-md rtl:rounded-r-md",value:i.privateUrlExpiration,onChange:e=>o({...i,privateUrlExpiration:e.currentTarget.value})}),(0,a.jsx)("div",{className:"bg-[#eee] flex justify-center items-center rounded-none px-3 font-semibold border border-white-light dark:border-[#17263c] dark:bg-[#1b2e4b] ",children:"days"})]})})]}),(0,a.jsxs)("div",{className:"w-10/12",children:[(0,a.jsxs)("p",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"font-semibold",children:"CDN Admins"}),(0,a.jsxs)("p",{children:["Every email you add to this comma-separated list ",(0,a.jsx)("strong",{children:"(no spaces)"})," will have ",(0,a.jsx)("strong",{children:"full read and write access to the storage bucket"})," and settings. They will be able to sign into this dashboard with their Google account."]})]}),(0,a.jsx)("p",{style:{textAlign:"right",marginRight:"30px"}}),(0,a.jsx)("div",{className:"",children:(0,a.jsx)("input",{type:"email",placeholder:"Enter Email",className:"form-input",onChange:e=>o({...i,cdnAdmins:e.currentTarget.value}),value:i.cdnAdmins})})]}),(0,a.jsx)("div",{className:"flex justify-end items-center mt-8",children:(0,a.jsx)("button",{className:"flex items-center btn btn-outline-dark relative text-[16px]",onClick:close,children:"Save"})})]})]})})})})]})})})})},fileManager=()=>{let[e,t]=(0,s.useState)(""),[l,r]=(0,s.useState)({}),[i,n]=(0,s.useState)(""),[o,c]=(0,s.useState)(!0),[d,p]=(0,s.useState)(!1),[h,u]=(0,s.useState)(!1),[m,x]=(0,s.useState)(!1);return(0,a.jsxs)("div",{className:"",children:[(0,a.jsx)("section",{className:"",children:(0,a.jsx)(FileExplorer_FileExplorer,{setFileUploadOpen:p,setFolderCreatorOpen:u,setSettingsOpen:x,idToken:e,profile:l,setExplorerPath:n,doRefresh:o,didRefresh:()=>c(!1)})}),(0,a.jsx)(FileUploadModal_FileUploadModal,{open:d,closeModal:()=>{p(!1),c(!o)},path:i,onSuccess:()=>{p(!1),c(!o)}}),(0,a.jsx)(FolderCreationModal,{open:h,closeModal:()=>u(!1),path:i,onSuccess:()=>{u(!1),c(!o)}}),(0,a.jsx)(SettingsModal_SettingsModal,{open:m,closeModal:()=>x(!1)})]})}}},function(e){e.O(0,[378,764,66,675,774,888,179],function(){return e(e.s=1094)}),_N_E=e.O()}]);